
==== Front
BioinformaticsbioinformaticsbioinfoBioinformatics1367-48031367-4811Oxford University Press 10.1093/bioinformatics/btq437btq437Applications NoteSystems BiologyA cell-based simulation software for multi-cellular systems Hoehme Stefan 1*Drasdo Dirk 12*1Interdisciplinary Centre for Bioinformatics, University of Leipzig, Germany and 2Institut National de Recherche en Informatique et en Automatique (INRIA) Unit Rocquencourt B.P.105, 78153 Le Chesnay Cedex, France* To whom correspondence should be addressed.Associate Editor: Trey Ideker

15 10 2010 13 8 2010 13 8 2010 26 20 2641 2642 11 6 2010 11 6 2010 25 7 2010 © The Author(s) 2010. Published by Oxford University Press.2010This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/2.5), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.CellSys is a modular software tool for efficient off-lattice simulation of growth and organization processes in multi-cellular systems in 2D and 3D. It implements an agent-based model that approximates cells as isotropic, elastic and adhesive objects. Cell migration is modeled by an equation of motion for each cell. The software includes many modules specifically tailored to support the simulation and analysis of virtual tissues including real-time 3D visualization and VRML 2.0 support. All cell and environment parameters can be independently varied which facilitates species specific simulations and allows for detailed analyses of growth dynamics and links between cellular and multi-cellular phenotypes.

Availability: CellSys is freely available for non-commercial use at http://msysbio.com/software/cellsys. The current version of CellSys permits the simulation of growing monolayer cultures and avascular tumor spheroids in liquid environment. Further functionality will be made available ongoing with published papers.

Contact: hoehme@izbi.uni-leipzig.de; dirk.drasdo@inria.fr

Supplementary information: Supplementary data are available at Bioinformatics online.
==== Body
1 INTRODUCTION
Based on the insight that multi-cellular systems are inherently of multi-scale nature, the focus of research in systems biology is currently shifting towards studies of whole cells or populations of cells to complement sequence analysis (Yu et al., 2002), gene expression profiles (Missal et al., 2006), research on signal transduction pathways (Swameye et al., 2003) and the analysis of biochemical systems (Calzone et al., 2006). Realistic multi-cellular approaches should permit both, to include models of sub-cellular processes and to simulate up to biologically or clinically relevant population sizes. For many years, this was hampered by the inherent computational complexity. However, depending on the level of represented detail the steadily increasing computational power of modern processors (CPUs and GPUs) today permits the simulation of up to several millions of cells by agent-based models (Anderson et al., 2007; Drasdo et al., 2007 and refs. therein) provided an efficient implementation especially in three dimensions.

Here we present an adaptable software tool (named CellSys) that implements a class of lattice-free agent-based models permitting realistic simulations of tissue growth and organization processes of common experimental settings in vitro, as the growth dynamics in monolayer cultures and multi-cellular spheroids (Drasdo and Hoehme, 2005). It has further recently been used to model liver regeneration (Hoehme et al., 2007, 2010). Therein, the simulation results from CellSys have been directly and quantitatively compared to experimental data, using the same analysis methods for both. CellSys can be used to predict the experiments that are most informative to identify possible mechanisms on the cell and sub-cell scale to explain a certain multi-cellular phenomenon. It also has proved useful to guide the development of continuous models where cells are not resolved individually but are represented by locally averaged quantities: Comparing both model types permits identification of terms and parameters (Byrne and Drasdo, 2009).

2 SIMULATION MODEL
Each individual cell is modeled by an isotropic, elastic and adhesive sphere capable of migration, growth and division. Cell–cell and cell–matrix interaction are mimicked by the experimentally validated (Chu et al., 2005) Johnson–Kendall–Roberts (JKR) model that summarizes deformation, compression and adhesion forces, and displays hysteresis if cells move close to or away from one another. Model cells are parameterized by the Young modulus, the Poisson ratio, the density of membrane receptors responsible for cell–cell and cell–substrate adhesion and by its (intrinsic) radius. Proliferating cells double volume and deform into dumb-bells after a given number of time steps before splitting into two daughter cells. By assuming that inertia terms can be neglected, cell migration is modeled by an (Langevin-) equation of motion for each cell center summarizing all JKR-forces on that cell, the friction-forces with substrate or extracellular matrix as well as with other cells (parameterized by friction coefficients), and optionally a random force term. The latter mimics cell micro-motility and is quantified by the cell diffusion constant. We solve the equation for diffusion and consumption of nutrients, growth factors, etc. on a lattice using the Euler forward method while fulfilling the Courant–Friedrichs–Lewy condition (Drasdo and Hoehme, 2005) [for further details, see Supplementary Material (Section 3)]. CellSys also supports the modeling of dynamically varying cell parameters and different cell types as demonstrated for growing cell populations in tissue like environments (submitted for publication). Since the model is completely parameterized in terms of measurable quantities, intracellular control modules can readily be integrated within CellSys by direct coupling the molecular concentrations of intracellular chemicals to the cell-level parameters (Ramis-Conde et al., 2008, 2009). Most recently, we used CellSys to predict a so far unknown mechanism in liver regeneration after toxic damage that could be subsequently validated experimentally (Hoehme et al., 2007, 2010).

3 SOFTWARE
CellSys is a software tool that efficiently integrates modeling, simulation, observation and visualization functionality for individual-cell (agent)-based models. It is implemented in portable object-oriented ANSI C++ and thus binaries are available for many operating systems including all recent Windows and Linux variants. A graphical user interface (GUI) that provides real-time visualization of models in 3D based on OpenGL (Fig. 1A) also serves to access the functionality of the software. CellSys is organized in encapsulated modules that lay the foundation for its extensibility and maintainability. Currently, it consists of the following main components: (i) basic classes formulating the major abstractions such as model cells or finite grid elements; (ii) a collection of core algorithms implementing model variants for cellular behavior such as cell-migration or cell-cycle-control; (iii) algorithms for modeling the cellular environment; (iv) modules for observing; and (v) visualizing properties of the cell population and its environment. During the model simulations, CellSys currently automatically permits taking over 60 different observables. Additionally, CellSys is able to output scene descriptions for example in VRML 2.0 or in the script language used in the popular open-source ray tracer PovRay (povray.org) (Fig. 1B). We use the libraries zlib (zlib.net) and libtiff (libtiff.org) to save screenshots, videos and zip-compressed model states in predefined intervals.
Fig. 1. (A) User interface of CellSys integrating real-time 3D visualization (upper window) and facilitating the parameterization, observation and visualization of model simulations (two exemplary windows are shown). (B) Simulated multi-cellular tumor grown in an environment of nutrient shortage. The image was created using the ray tracer interface of CellSys.



The cross-platform GUI is based on the GLUI library (glui.sourceforge.net) and is used to change parameter settings and control the software components (1–5). It allows users to interactively explore model states and, e.g. mark specific properties of cells and their environment. Thereby scalar properties are often mapped to RGB-color vectors as illustrated in Figure 1 and vector-based properties are visualized using 2D or 3D vector fields.

The core algorithms in CellSys are parallelized using OpenMP (openmp.org) to exploit the computational power of modern shared memory multi-core multi-processor machines. The solution of the stochastic equations of motion (Langevin) is supported by the multithreaded version of SuperLU for shared-memory parallel machines (crd.lbl.gov/∼xiaoye/SuperLU). We find the solution of the equations of motion and the neighbor detection to be the major performance bottlenecks of lattice-free individual-cell-based models. On an Intel Core Duo E8500 system with 8 GB RAM a typical simulation from 1 to 105 cells e.g. takes 44 h (2D, 1 core), 125 h (3D, 1 core) or 41 h (3D, 4 cores). However, runtimes greatly depend on parameter and algorithm choices. For a more detailed introduction refer to the Supplementary Material.

4 SUMMARY/OUTLOOK
CellSys offers a robust and efficient implementation of a lattice-free individual-cell-based model that is parameterized by experimentally measurable quantities. The current version allows the in silico simulation and analysis of widespread experimental settings in 2D and 3D such as monolayer cultures and multi-cellular tumor spheroids. Specific cell lines and culturing settings can be mimicked by changing parameters accordingly. The results of model simulations can be visualized by a wide variety of virtual stainings and are quantified by many observables. The modular, object-oriented structure of the software permits extensions like the modeling of the surrounding tissue or vascular networks that will be made available in future versions of CellSys.

Funding: German Federal Ministry of Education and Research [HepatoSys 0313081F, LungSys 0315415F and VirtualLiver 0315735, in part]; European Union [CancerSys HEALTH-F4-2008-223188, Passport: 223894, in part].

Conflict of Interest: none declared.

Supplementary Material
Supplementary Data
==== Refs
REFERENCES
Anderson ARA    Single-Cell-Based Models in Biology and Medicine. 2007 Basel Birkhäuser 
Byrne H  Drasdo D   Individual-based and continuum models of growing cell populations: a comparison J. Math. Biol. 2009 58 657 687 18841363 
Chu YS    Johnson-Kendall-Roberts theory applied to living cells Phys. Rev. Lett. 2005 94 028102 15698233 
Calzone L    BIOCHAM: an environment for modeling biological systems and formalizing experimental knowledge Bioinformatics 2006 22 1805 1807 16672256 
Drasdo D    On the role of physics in the growth and pattern formation of multi-cellular systems J. Stat. Phys. 2007 128 287 345 
Drasdo D  Hoehme S   A single-cell-based model of tumor growth in vitro: monolayers and spheroids Phys. Biol. 2005 2 133 147 16224119 
Hoehme S    Mathematical modelling of liver regeneration after intoxication with CCl4  Chem. Biol. Interact. 2007 168 74 93 17442287 
Hoehme S    Prediction and validation of cell alignment along microvessels as order principle to restore tissue architecture in liver regeneration Proc. Natl Acad. Sci. USA 2010 107 10371 10376 20484673 
Missal K   Gene network inference from incomplete expression data: transcriptional control of hematopoietic commitment Bioinformatics 2006 22 731 738 16332705 
Ramis-Conde I    Modeling the influence of the E-cadherin-beta-catenin pathway in cancer cell invasion: a multiscale approach Biophys. J. 2008 95 155 165 18339758 
Ramis-Conde I    Multi-scale modelling of cancer cell intravasation: the role of cadherins in metastasis Phys Biol. 2009 6 16008 
Swameye I    Identification of nucleocytoplasmic cycling as a remote sensor in cellular signaling by databased modeling Proc. Natl Acad. Sci. USA 2003 100 1028 1033 12552139 
Yu YK    Hybrid alignment: high-performance with universal statistics Bioinformatics 2002 18 864 872 12075022
