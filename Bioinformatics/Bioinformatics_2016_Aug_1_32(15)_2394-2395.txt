
==== Front
BioinformaticsBioinformaticsbioinformaticsbioinfoBioinformatics1367-48031367-4811Oxford University Press 10.1093/bioinformatics/btw109btw109Applications NotesSystems BiologySimulated single molecule microscopy with SMeagol Lindén Martin Ćurić Vladimir Boucharin Alexis Fange David Elf Johan *Department of Cell and Molecular Biology, Science for Life Laboratory, Uppsala University, Uppsala, Sweden*To whom correspondence should be addressed.Associate Editor: Alfonso Valencia

01 8 2016 04 3 2016 04 3 2016 32 15 2394 2395 01 11 2015 05 2 2016 19 2 2016 © The Author 2016. Published by Oxford University Press.2016This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/4.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.comSummary: SMeagol is a software tool to simulate highly realistic microscopy data based on spatial systems biology models, in order to facilitate development, validation and optimization of advanced analysis methods for live cell single molecule microscopy data.

Availability and implementation: SMeagol runs on Matlab R2014 and later, and uses compiled binaries in C for reaction–diffusion simulations. Documentation, source code and binaries for Mac OS, Windows and Ubuntu Linux can be downloaded from http://smeagol.sourceforge.net.

Contact:
johan.elf@icm.uu.se

Supplementary information: Supplementary data are available at Bioinformatics online.
==== Body
Recent advances in single particle tracking (SPT) microscopy (Manley et al., 2008) make it possible to obtain tens of thousands macromolecular trajectories from within a living cell in just a few minutes. Since molecules typically change their movement properties upon interactions, these trajectories contain information about both locations and rates of intracellular reactions. This information is unfortunately obscured by physical limitations of the optical microscope and noise in detection systems, making statistical methods development for SPT analysis a very active research field. Unbiased testing and comparison of such methods are however difficult given the absence of in vivo data of intracellular dynamics where the true states of interaction are known, a.k.a. the ‘ground truth’. A common resort is to instead use simulated, synthetic, data. However, tests using such data give unrealistically optimistic results if the simplifying assumptions underlying the analysis method are exactly satisfied. The need for realistic simulations is long recognized in microscopy and systems biology (Andrews, 2012; Chenouard et al., 2014; Cox et al., 2012; Fange et al., 2012; Fullerton et al., 2012; Kerr et al., 2008; Sage et al., 2015; Sinkó et al., 2014; Slepchenko et al., 2002; Takahashi et al., 2010), but systematic combinations of the two are only currently emerging (Angiolini et al., 2015; Watabe et al., 2015).

We present the SMeagol package, that has been developed to generate highly realistic single molecule microscopy time-lapse image series aimed primarily at single particle tracking applications. The purpose of SMeagol is to enable realistic comparisons between the output of advanced analysis methods and known ground truth. SMeagol includes an extended MesoRD (Fange et al., 2012) version for simulation of 3D diffusion in cellular compartments, diffusion limited reaction kinetics, surface adsorption, reactions in membranes and other complex aspects of reaction diffusion kinetics that do occur in cells, but are not considered in SPT analysis algorithms. In addition to the molecules’ trajectories, SMeagol integrates the 3D point spread function of the microscope, the kinetics of photo-activation, blinking and bleaching of the simulated fluorophores, background noise and camera specific parameters (Fig. 1, movie S1 and S2). Great flexibility is allowed by the possibility to supply these characteristic parameters either as tabulated experimental data for a particular optical setup, or as theoretical models. The combination of using reaction diffusion kinetics in cellular geometries and physics-based simulations of the emission and detection processes makes the images more realistic than the synthetic data used for example by Chenouard et al. (2014).
Fig. 1. Simulated microscopy with SMeagol. (a) Workflow from stochastic reaction–diffusion simulations to images. (b) The microscopy simulation starts from trajectories generated by stochastic reaction–diffusion simulations, fills in stochastic motion and photon emission events between the trajectory points, and finally combines PSF and camera noise models to simulate realistic images. (c) Simulated microscopy of fluorescently labeled MinE proteins in the Min oscillatory system. Left: Stochastic reaction–diffusion simulation. Mid columns: Simulated SPT microscopy using an actual experimental background noise movie with continuous illumination and 4 ms/frame. Right: A simulation of continuous illumination and 1 s/frame renders a conventional (non-single molecule) fluorescence microscopy time-lapse movie. See also Supplementary movies S1, S2 and the Supplementary material for further details (Color version of this figure is available at Bioinformatics online.)




SMeagol can be used to optimize imaging conditions for specific systems in silico and to benchmark methods for SPT analysis in analogy with the methods that has been developed to benchmark localization methods for non-moving single particles (Sage et al., 2015). In the supplementary material, we explore the robustness against localization errors and motional blur of the vbSPT software, which extracts multi-state diffusive models from SPT data (Persson et al., 2013), and find that these effects can induce overfitting under certain conditions. In addition, we provide a number of examples highlighting possibilities, limitation and computational requirements of the SMeagol simulation engine.

When combined with increasingly refined simulations of intracellular processes, photo-physics and optics; live-cell microscopy is moving closer to methods in fundamental physics, where combined simulation of physical processes and detection systems have guided experimental design and data analysis for a long time.

Supplementary Material
Supplementary Data
 Acknowledgements
We thank Fredrik Persson and Elias Amselem for helpful discussions.

Funding
This work was supported by the European Research Council (Grant no. 616047), Vetenskapsrådet, the Knut and Alice Wallenberg Foundation, the Foundation for Strategic Research, and the Swedish strategic research programme eSSENCE.

Conflict of Interest: none declared.
==== Refs
References
Andrews S.S.   (2012 ) Spatial and stochastic cellular modeling with the Smoldyn simulator In: van Helden J.  
 (eds.) Bacterial Molecular Networks , vol. 804 
Springer , New York , pp. 519 –542 .
Angiolini J  
 (2015 ) Exploring the dynamics of cell processes through simulations of fluorescence microscopy experiments . Biophys. J ., 108 , 2613 –2618 .26039162 
Chenouard N  
 (2014 ) Objective comparison of particle tracking methods . Nat. Methods , 11 , 281 –289 .24441936 
Cox S  
 (2012 ) Bayesian localization microscopy reveals nanoscale podosome dynamics . Nat. Methods , 9 , 195 –200 .22138825 
Fange D  
 (2012 ) MesoRD 1.0: Stochastic reaction–diffusion simulations in the microscopic limit . Bioinformatics , 28 , 3155 –3157 .23044538 
Fullerton S  
 (2012 ) Camera simulation engine enables efficient system optimization for super-resolution imaging . SPIE , 8228 , 822811 –822817 .
Kerr R.A  
 (2008 ) Fast Monte Carlo simulation methods for biological reaction-diffusion systems in solution and on surfaces . SIAM J. Sci. Comput ., 30 , 3126 –3149 .20151023 
Manley S  
 (2008 ) High-density mapping of single-molecule trajectories with photoactivated localization microscopy . Nat. Methods , 5 , 155 –157 .18193054 
Persson F  
 (2013 ) Extracting intracellular diffusive states and transition rates from single-molecule tracking data . Nat. Methods , 10 , 265 –269 .23396281 
Sage D  
 (2015 ) Quantitative evaluation of software packages for single-molecule localization microscopy . Nat. Methods , 12 , 717 –724 .26076424 
Sinkó J  
 (2014 ) TestSTORM: simulator for optimizing sample labeling and image acquisition in localization based super-resolution microscopy . Biomed. Opt. Express , 5 , 778 –787 .24688813 
Slepchenko B.M  
 (2002 ) Computational cell biology: spatiotemporal simulation of cellular events . Annu. Rev. Biophys. Biomol. Struct ., 31 , 423 –441 .11988477 
Takahashi K  
 (2010 ) Spatio-temporal correlations can drastically change the response of a MAPK pathway . Proc. Natl. Acad. Sci. U. S. A ., 107 , 2473 –2478 .20133748 
Watabe M  
 (2015 ) A computational framework for bioimaging simulation . PLoS ONE , 10 , e0130089 .26147508
